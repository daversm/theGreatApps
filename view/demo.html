<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Sign up</title>
    <!-- Not present in the tutorial. Just for basic styling. -->
    <link rel="stylesheet" href="../public/css/base.css"  />
    <script src="../public/tracks.js"></script>
    <script src="../public/Recorderjs/recorder.js"></script>
    <script src="../public/wavesurfer.min.js"></script>
    <script src="../public/wavesurfer.microphone.js"></script>
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700,900,100italic,300italic,400italic,500italic' rel='stylesheet' type='text/css'>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.15/browser.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.2/marked.min.js"></script>
  </head>
  <body>
    <div class="logo"><h5>TGA</h6></div>
    <div id="masterPanel"></div>
    <div id="tracksDiv"></div>
    <div id="controlPanel">
      <button onclick="record()">Record</button>
      <button onclick="stop()">Stop</button>
      <button onclick="pause()">Pause</button>
      <button onclick="start()">Start</button>
      <button onclick="download()">Download</button>
    </div>
      <script type="text/babel">


      var MasterController = React.createClass({
        getInitialState: function() {
          return {micSwitchState: false};
        },
        handleMasterPlay: function(){
          console.log(this.mediaStream);
        },
        handleMicSwitchChange: function(e) {
          console.log(e.target.checked);
          var outerThis = this;
          if(e.target.checked == true){
            navigator.getUserMedia({audio: true}, function(localMediaStream){
              outerThis.mediaStream = localMediaStream;

            }, function(err){
              console.log('Browser not supported');
            });
          }else{
            outerThis.mediaStream.getTracks()[0].stop();
          }
        },

        render: function() {
          var navigator = window.navigator;
          navigator.getUserMedia = ( navigator.getUserMedia ||
                                 navigator.webkitGetUserMedia ||
                                 navigator.mozGetUserMedia ||
                                 navigator.msGetUserMedia);

          var Context = window.AudioContext || window.webkitAudioContext;
          var context = new Context();

          var rec;

          return (
            <div className="masterControllPanel" >
              <p>MASTER CONTROLLER</p>
              <div className="onoffswitch">
                  <input
                        type="checkbox" name="onoffswitch" className="onoffswitch-checkbox"
                        id="myonoffswitch" onChange={this.handleMicSwitchChange} checked={this.micSwitchState}
                  />
                  <label className="onoffswitch-label" htmlFor="myonoffswitch">
                      <span className="onoffswitch-inner"></span>
                      <span className="onoffswitch-switch"></span>
                  </label>
              </div>
              <div id="play" onClick={this.handleMasterPlay}></div>
              <div id="pause"></div>
              <div id="stop"></div>
              <div id="rec"></div>
            </div>
          );
        }
      });

      ReactDOM.render(
      <MasterController />,
      document.getElementById('masterPanel')
      );


      </script>

  </body>
</html>
